// FILE: prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Currency {
  GBP
  USD
  EUR
  CAD
  AUD
  JPY
}

enum ItemCondition {
  NEW
  LIKE_NEW
  GOOD
  FAIR
  POOR
}

enum ItemCategory {
  CLOTHING
  SHOES
  TECH
  COLLECTIBLES
  TRADING_CARDS
  WATCHES
  BAGS
  HOME
  BOOKS
  TOYS
  BEAUTY
  OTHER
}

enum ItemStatus {
  UNLISTED
  LISTED
  SOLD
}

enum SellingPlatform {
  NONE
  EBAY
  VINTED
  DEPOP
  STOCKX
  GOAT
  GRAILED
  FACEBOOK
  ETSY
  OTHER
}

model Item {
  id        String   @id @default(cuid())
  userId    String
  name      String

  sku       String?
  quantity  Int      @default(1)

  currency          Currency      @default(GBP)

  // YOUR TOTAL COST BASIS (per unit, all-in)
  // purchaseSubtotal = item price you paid
  // purchaseFees = payment fees etc
  // purchaseShipping = postage you paid
  purchaseSubtotalPence Int @default(0)
  purchaseFeesPence     Int @default(0)
  purchaseShippingPence Int @default(0)

  // LISTING / SELLING
  status   ItemStatus      @default(UNLISTED)
  platform SellingPlatform @default(NONE)

  listedPricePence        Int?      // price shown on listing (per unit)
  buyerTotalPence         Int?      // total buyer pays (incl buyer postage etc) (per unit)
  soldAt  DateTime?

  // FEES (per unit)
  platformFeePence        Int?      // platform fee
  paymentProcessingFeePence Int?    // stripe/paypal etc
  postageChargedToBuyerPence Int?   // the shipping buyer paid (if tracked separately)

  // EXPECTED RANGE (optional) (per unit)
  expectedBestPence  Int?
  expectedWorstPence Int?

  condition ItemCondition @default(GOOD)
  category  ItemCategory  @default(OTHER)

  notes     String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId])
  @@index([userId, status])
  @@index([userId, category])
  @@index([userId, condition])

  @@unique([userId, sku])
}
